"0","poisson_model_quad = "
"0","""model{"
"0","  # Likelihood"
"0","  for(i in 1:length(Y)){"
"0","    Y[i] ~ dpois(lambda[i])"
"0","    log(lambda[i]) <- beta[1] + beta[2]*(X[i] - 1981) + beta[3]*(X[i] - 1981)^2"
"0","    "
"0","    # In-sample prediction"
"0","    Y_hat[i] ~ dpois(lambda[i])"
"0","  }"
"0","  # Prior for beta"
"0","  for(j in 1:3){"
"0","    beta[j] ~ dnorm(0,1/100)"
"0","  }"
"0","}"""
"0","m_quad = jags.model("
"0","  textConnection(poisson_model_quad), quiet = TRUE,"
"0","  data = list(Y=aids$cases, X=aids$year)"
"0",") "
"0","update(m_quad, n.iter=1000, progress.bar=""none"")"
"0","samp_quad = coda.samples("
"0","  m_quad, variable.names=c(""beta"",""lambda"",""Y_hat""), "
"0","  n.iter=5000, progress.bar=""none"""
"0",")"
"0","y_hat_quad = get_coda_parameter(samp_quad, ""Y_hat"")"
"0","aids_bpred_quad = cbind("
"0","  aids,"
"0","  post_summary(y_hat_quad)"
"0",")"
"0","aids_quad = aids_base +"
"0","  geom_ribbon(data=aids_bpred_quad, aes(ymin = post_lower, ymax = post_upper), fill='blue', alpha=0.3) +"
"0","  geom_line(data=aids_bpred_quad, aes(y = post_mean), color='red') +"
"0","  labs(subtitle=""(Quadratic Poisson Model)"")"
"0","print(aids_quad)"
