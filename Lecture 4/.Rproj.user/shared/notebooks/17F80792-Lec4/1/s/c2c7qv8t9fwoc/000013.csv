"0","f2 = glm(presence~.+I(SegSumT^2), data=anguilla, family=binomial)"
"0","summary(f2)"
"1","
Call:
"
"1","glm(formula = presence ~ . + I(SegSumT^2), family = binomial, 
    data = anguilla)"
"1","

"
"1","Deviance Residuals: 
"
"1","     Min  "
"1","      1Q  "
"1","  Median  "
"1","      3Q  "
"1","     Max  "
"1","
"
"1","-2.09241  "
"1","-0.57666  "
"1","-0.26048  "
"1","-0.02316  "
"1"," 2.99017  "
"1","
"
"1","
Coefficients:
"
"1","             "
"1","   Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","    "
"1","
(Intercept)  "
"1"," -63.614787"
"1","  22.585115"
"1","  -2.817"
"1","  0.00485"
"1"," ** "
"1","
SegSumT      "
"1","   7.175469"
"1","   2.666667"
"1","   2.691"
"1","  0.00713"
"1"," ** "
"1","
DSDist       "
"1","  -0.003869"
"1","   0.002158"
"1","  -1.793"
"1","  0.07296"
"1"," .  "
"1","
DSMaxSlope   "
"1","  -0.128906"
"1","   0.067778"
"1","  -1.902"
"1","  0.05719"
"1"," .  "
"1","
USRainDays   "
"1","  -0.632217"
"1","   0.223784"
"1","  -2.825"
"1","  0.00473"
"1"," ** "
"1","
USSlope      "
"1","  -0.066911"
"1","   0.026264"
"1","  -2.548"
"1","  0.01084"
"1"," *  "
"1","
USNative     "
"1","  -0.283431"
"1","   0.471036"
"1","  -0.602"
"1","  0.54736"
"1","    "
"1","
DSDam        "
"1","  -1.015057"
"1","   0.514068"
"1","  -1.975"
"1","  0.04832"
"1"," *  "
"1","
Methodmixture"
"1","   0.081875"
"1","   0.509820"
"1","   0.161"
"1","  0.87241"
"1","    "
"1","
Methodnet    "
"1","  -1.137531"
"1","   0.502683"
"1","  -2.263"
"1","  0.02364"
"1"," *  "
"1","
Methodspo    "
"1","  -1.537345"
"1","   0.806835"
"1","  -1.905"
"1","  0.05673"
"1"," .  "
"1","
Methodtrap   "
"1","  -2.895911"
"1","   0.686317"
"1","  -4.219"
"1"," 2.45e-05"
"1"," ***"
"1","
LocSed       "
"1","  -0.233322"
"1","   0.099856"
"1","  -2.337"
"1","  0.01946"
"1"," *  "
"1","
I(SegSumT^2) "
"1","  -0.193490"
"1","   0.078021"
"1","  -2.480"
"1","  0.01314"
"1"," *  "
"1","
"
"1","---
Signif. codes:  "
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1","binomial"
"1"," family taken to be "
"1","1"
"1",")

"
"1","    Null deviance: 630.04  on 616  degrees of freedom
"
"1","Residual deviance: 426.80  on 603  degrees of freedom
"
"1","AIC: "
"1","454.8"
"1","

"
"1","Number of Fisher Scoring iterations: "
"1","7"
"1","
"
"1","
"
"0","d_f2 = anguilla %>%"
"0","  add_predictions(f2, var=""p_hat"") %>%"
"0","  mutate(p_hat = inv_logit(p_hat)) %>%"
"0","  mutate(p_hat_bin = p_hat - (p_hat %% 0.025)) %>%"
"0","  mutate("
"0","    resid = presence - p_hat,"
"0","    pearson = (presence - p_hat)/(p_hat*(1-p_hat)),"
"0","    deviance = sign(presence-p_hat) * sqrt(-2 * (presence * log(p_hat) + (1-presence) * log(1-p_hat)))"
"0","  )"
"0","rbind("
"0","  cbind(d_f,  model=""linearT""),"
"0","  cbind(d_f2, model=""quadT"")"
"0",") %>%"
"0","  ggplot(aes(x=SegSumT, y=deviance, color=as.factor(presence))) + geom_point() + facet_wrap(~model)"
